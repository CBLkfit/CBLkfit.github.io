<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>学习fairseq之Roberta | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="git clone https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;fairseq.git cd fairseq pip install --editable .&#x2F; For MacOS: CFLAGS&#x3D;&quot;-stdlib&#x3D;libc++&quot; pip install --editable .&#x2F; 接下来可以参考https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;fairseq&#x2F;b">
<meta property="og:type" content="article">
<meta property="og:title" content="学习fairseq之Roberta">
<meta property="og:url" content="http://example.com/2020/12/28/%E5%AD%A6%E4%B9%A0fairseq%E4%B9%8BRoberta/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="git clone https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;fairseq.git cd fairseq pip install --editable .&#x2F; For MacOS: CFLAGS&#x3D;&quot;-stdlib&#x3D;libc++&quot; pip install --editable .&#x2F; 接下来可以参考https:&#x2F;&#x2F;github.com&#x2F;pytorch&#x2F;fairseq&#x2F;b">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-12-28T09:14:27.000Z">
<meta property="article:modified_time" content="2020-12-28T09:52:07.416Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-学习fairseq之Roberta" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/28/%E5%AD%A6%E4%B9%A0fairseq%E4%B9%8BRoberta/" class="article-date">
  <time class="dt-published" datetime="2020-12-28T09:14:27.000Z" itemprop="datePublished">2020-12-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      学习fairseq之Roberta
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><code>git clone https://github.com/pytorch/fairseq.git</code></p>
<p><code>cd fairseq</code></p>
<p><code>pip install --editable ./</code></p>
<p>For MacOS:</p>
<p><code>CFLAGS=&quot;-stdlib=libc++&quot; pip install --editable ./</code></p>
<p>接下来可以参考<a target="_blank" rel="noopener" href="https://github.com/pytorch/fairseq/blob/master/examples/roberta/README.pretraining.md">https://github.com/pytorch/fairseq/blob/master/examples/roberta/README.pretraining.md</a> </p>
<p>下载数据集<em>WikiText-103</em>：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https:<span class="comment">//s3.amazonaws.com/research.metamind.io/wikitext/wikitext-103-raw-v1.zip</span></span><br><span class="line">unzip wikitext-<span class="number">103</span>-raw-v1.zip</span><br></pre></td></tr></table></figure>
<p>将数据集按照GPT-2 BPE进行编码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p gpt2_bpe</span><br><span class="line">wget -O gpt2_bpe/encoder.json https:<span class="comment">//dl.fbaipublicfiles.com/fairseq/gpt2_bpe/encoder.json</span></span><br><span class="line">wget -O gpt2_bpe/vocab.bpe https:<span class="comment">//dl.fbaipublicfiles.com/fairseq/gpt2_bpe/vocab.bpe</span></span><br><span class="line"><span class="keyword">for</span> SPLIT <span class="keyword">in</span> train valid test; <span class="keyword">do</span> \</span><br><span class="line">    python -m examples.roberta.multiprocessing_bpe_encoder \</span><br><span class="line">        --encoder-json gpt2_bpe/encoder.json \</span><br><span class="line">        --vocab-bpe gpt2_bpe/vocab.bpe \</span><br><span class="line">        --inputs wikitext-<span class="number">103</span>-raw/wiki.$&#123;SPLIT&#125;.raw \</span><br><span class="line">        --outputs wikitext-<span class="number">103</span>-raw/wiki.$&#123;SPLIT&#125;.bpe \</span><br><span class="line">        --keep-empty \</span><br><span class="line">        --workers <span class="number">60</span>; \</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">wget -O gpt2_bpe/dict.txt https:<span class="comment">//dl.fbaipublicfiles.com/fairseq/gpt2_bpe/dict.txt</span></span><br><span class="line">fairseq-preprocess \</span><br><span class="line">    --only-source \</span><br><span class="line">    --srcdict gpt2_bpe/dict.txt \</span><br><span class="line">    --trainpref wikitext-<span class="number">103</span>-raw/wiki.train.bpe \</span><br><span class="line">    --validpref wikitext-<span class="number">103</span>-raw/wiki.valid.bpe \</span><br><span class="line">    --testpref wikitext-<span class="number">103</span>-raw/wiki.test.bpe \</span><br><span class="line">    --destdir data-bin/wikitext-<span class="number">103</span> \</span><br><span class="line">    --workers <span class="number">60</span></span><br></pre></td></tr></table></figure>
<p>得到<em>data-bin/wikitext-103</em> 文件夹，文件夹下是预处理好的数据集。</p>
<p>接下来可以开始训练啦，需要用到GPU资源。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">TOTAL_UPDATES=125000    # Total number of training steps</span><br><span class="line">WARMUP_UPDATES=10000    # Warmup the learning rate over this many updates</span><br><span class="line">PEAK_LR=0.0005          # Peak learning rate, adjust as needed</span><br><span class="line">TOKENS_PER_SAMPLE=512   # Max sequence length</span><br><span class="line">MAX_POSITIONS=512       # Num. positional embeddings (usually same as above)</span><br><span class="line">MAX_SENTENCES=16        # Number of sequences per batch (batch size)</span><br><span class="line">UPDATE_FREQ=16          # Increase the batch size 16x</span><br><span class="line"></span><br><span class="line">DATA_DIR=data-bin/wikitext-<span class="number">103</span></span><br><span class="line"></span><br><span class="line">fairseq-train --fp16 $DATA_DIR \</span><br><span class="line">    --task masked_lm --criterion masked_lm \</span><br><span class="line">    --arch roberta_base --sample-<span class="keyword">break</span>-mode complete --tokens-per-sample $TOKENS_PER_SAMPLE \</span><br><span class="line">    --optimizer adam --adam-betas <span class="string">&#x27;(0.9,0.98)&#x27;</span> --adam-eps <span class="number">1e-6</span> --clip-norm <span class="number">0.0</span> \</span><br><span class="line">    --lr-scheduler polynomial_decay --lr $PEAK_LR --warmup-updates $WARMUP_UPDATES --total-num-update $TOTAL_UPDATES \</span><br><span class="line">    --dropout <span class="number">0.1</span> --attention-dropout <span class="number">0.1</span> --weight-decay <span class="number">0.01</span> \</span><br><span class="line">    --batch-size $MAX_SENTENCES --update-freq $UPDATE_FREQ \</span><br><span class="line">    --max-update $TOTAL_UPDATES --log-format simple --log-interval <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>如果出现如下错误信息：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">Error</span>: mkl-service + Intel(R) MKL: MKL_THREADING_LAYER=INTEL is incompatible <span class="keyword">with</span> libgomp.so<span class="number">.1</span> library.</span><br><span class="line">        Try to <span class="keyword">import</span> numpy first or set the threading layer accordingly. <span class="built_in">Set</span> MKL_SERVICE_FORCE_INTEL to force it.</span><br></pre></td></tr></table></figure>
<p>在*~/.bashrc* 中添加<code>export MKL_THREADING_LAYER=GNU</code>就可以解决：</p>
<p>Warning</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/home/User/miniconda3/lib/python3<span class="number">.8</span>/site-packages/torch/nn/parallel/distributed.py:<span class="number">397</span>: UserWarning: The <span class="string">`check_reduction`</span> argument <span class="keyword">in</span> <span class="string">`DistributedDataParallel`</span> <span class="built_in">module</span> is deprecated. Please avoid using it.</span><br></pre></td></tr></table></figure>


<p>8卡服务器运行：</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 0): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 1): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 2): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 6): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 5): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 3): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 4): tcp://localhost:12737</p>
<p>2020-12-28 15:40:38 | INFO | fairseq.distributed_utils | distributed init (rank 7): tcp://localhost:12737</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 5</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 6</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 0</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 7</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 3</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 2</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 4</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.distributed_utils | initialized host song1-SYS-4029GP-TRT as rank 1</p>
<p>2020-12-28 15:40:45 | INFO | fairseq_cli.train | {‘_name’: None, ‘common’: {‘_name’: None, ‘no_progress_bar’: False, ‘log_interval’: 1, ‘log_format’: ‘simple’, ‘tensorboard_logdir’: None, ‘wandb_project’: None, ‘azureml_logging’: False, ‘seed’: 1, ‘cpu’: False, ‘tpu’: False, ‘bf16’: False, ‘memory_efficient_bf16’: False, ‘fp16’: True, ‘memory_efficient_fp16’: False, ‘fp16_no_flatten_grads’: False, ‘fp16_init_scale’: 128, ‘fp16_scale_window’: None, ‘fp16_scale_tolerance’: 0.0, ‘min_loss_scale’: 0.0001, ‘threshold_loss_scale’: None, ‘user_dir’: None, ‘empty_cache_freq’: 0, ‘all_gather_list_size’: 16384, ‘model_parallel_size’: 1, ‘quantization_config_path’: None, ‘profile’: False, ‘reset_logging’: True}, ‘common_eval’: {‘_name’: None, ‘path’: None, ‘post_process’: None, ‘quiet’: False, ‘model_overrides’: ‘{}’, ‘results_path’: None}, ‘distributed_training’: {‘_name’: None, ‘distributed_world_size’: 8, ‘distributed_rank’: 0, ‘distributed_backend’: ‘nccl’, ‘distributed_init_method’: ‘tcp://localhost:12737’, ‘distributed_port’: -1, ‘device_id’: 0, ‘distributed_no_spawn’: False, ‘ddp_backend’: ‘c10d’, ‘bucket_cap_mb’: 25, ‘fix_batches_to_gpus’: False, ‘find_unused_parameters’: False, ‘fast_stat_sync’: False, ‘heartbeat_timeout’: -1, ‘broadcast_buffers’: False, ‘distributed_wrapper’: ‘DDP’, ‘slowmo_momentum’: None, ‘slowmo_algorithm’: ‘LocalSGD’, ‘localsgd_frequency’: 3, ‘nprocs_per_node’: 8, ‘pipeline_model_parallel’: False, ‘pipeline_balance’: None, ‘pipeline_devices’: None, ‘pipeline_chunks’: 0, ‘pipeline_encoder_balance’: None, ‘pipeline_encoder_devices’: None, ‘pipeline_decoder_balance’: None, ‘pipeline_decoder_devices’: None, ‘pipeline_checkpoint’: ‘never’, ‘zero_sharding’: ‘none’, ‘tpu’: False, ‘distributed_num_procs’: 8}, ‘dataset’: {‘_name’: None, ‘num_workers’: 1, ‘skip_invalid_size_inputs_valid_test’: False, ‘max_tokens’: None, ‘batch_size’: 16, ‘required_batch_size_multiple’: 8, ‘required_seq_len_multiple’: 1, ‘dataset_impl’: None, ‘data_buffer_size’: 10, ‘train_subset’: ‘train’, ‘valid_subset’: ‘valid’, ‘validate_interval’: 1, ‘validate_interval_updates’: 0, ‘validate_after_updates’: 0, ‘fixed_validation_seed’: None, ‘disable_validation’: False, ‘max_tokens_valid’: None, ‘batch_size_valid’: 16, ‘curriculum’: 0, ‘gen_subset’: ‘test’, ‘num_shards’: 1, ‘shard_id’: 0}, ‘optimization’: {‘_name’: None, ‘max_epoch’: 0, ‘max_update’: 125000, ‘stop_time_hours’: 0.0, ‘clip_norm’: 0.0, ‘sentence_avg’: False, ‘update_freq’: [16], ‘lr’: [0.0005], ‘stop_min_lr’: -1.0, ‘use_bmuf’: False}, ‘checkpoint’: {‘_name’: None, ‘save_dir’: ‘checkpoints’, ‘restore_file’: ‘checkpoint_last.pt’, ‘finetune_from_model’: None, ‘reset_dataloader’: False, ‘reset_lr_scheduler’: False, ‘reset_meters’: False, ‘reset_optimizer’: False, ‘optimizer_overrides’: ‘{}’, ‘save_interval’: 1, ‘save_interval_updates’: 0, ‘keep_interval_updates’: -1, ‘keep_last_epochs’: -1, ‘keep_best_checkpoints’: -1, ‘no_save’: False, ‘no_epoch_checkpoints’: False, ‘no_last_checkpoints’: False, ‘no_save_optimizer_state’: False, ‘best_checkpoint_metric’: ‘loss’, ‘maximize_best_checkpoint_metric’: False, ‘patience’: -1, ‘checkpoint_suffix’: ‘’, ‘checkpoint_shard_count’: 1, ‘load_checkpoint_on_all_dp_ranks’: False, ‘model_parallel_size’: 1, ‘distributed_rank’: 0}, ‘bmuf’: {‘_name’: None, ‘block_lr’: 1.0, ‘block_momentum’: 0.875, ‘global_sync_iter’: 50, ‘warmup_iterations’: 500, ‘use_nbm’: False, ‘average_sync’: False, ‘distributed_world_size’: 8}, ‘generation’: {‘_name’: None, ‘beam’: 5, ‘nbest’: 1, ‘max_len_a’: 0.0, ‘max_len_b’: 200, ‘min_len’: 1, ‘match_source_len’: False, ‘unnormalized’: False, ‘no_early_stop’: False, ‘no_beamable_mm’: False, ‘lenpen’: 1.0, ‘unkpen’: 0.0, ‘replace_unk’: None, ‘sacrebleu’: False, ‘score_reference’: False, ‘prefix_size’: 0, ‘no_repeat_ngram_size’: 0, ‘sampling’: False, ‘sampling_topk’: -1, ‘sampling_topp’: -1.0, ‘constraints’: None, ‘temperature’: 1.0, ‘diverse_beam_groups’: -1, ‘diverse_beam_strength’: 0.5, ‘diversity_rate’: -1.0, ‘print_alignment’: None, ‘print_step’: False, ‘lm_path’: None, ‘lm_weight’: 0.0, ‘iter_decode_eos_penalty’: 0.0, ‘iter_decode_max_iter’: 10, ‘iter_decode_force_max_iter’: False, ‘iter_decode_with_beam’: 1, ‘iter_decode_with_external_reranker’: False, ‘retain_iter_history’: False, ‘retain_dropout’: False, ‘retain_dropout_modules’: None, ‘decoding_format’: None, ‘no_seed_provided’: False}, ‘eval_lm’: {‘_name’: None, ‘output_word_probs’: False, ‘output_word_stats’: False, ‘context_window’: 0, ‘softmax_batch’: 9223372036854775807}, ‘interactive’: {‘_name’: None, ‘buffer_size’: 0, ‘input’: ‘-‘}, ‘model’: Namespace(_name=’roberta_base’, activation_dropout=0.0, activation_fn=’gelu’, adam_betas=’(0.9,0.98)’, adam_eps=1e-06, all_gather_list_size=16384, arch=’roberta_base’, attention_dropout=0.1, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric=’loss’, bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix=’’, clip_norm=0.0, cpu=False, criterion=’masked_lm’, curriculum=0, data=’data-bin/wikitext-103’, data_buffer_size=10, dataset_impl=None, ddp_backend=’c10d’, device_id=0, disable_validation=False, distributed_backend=’nccl’, distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=8, distributed_wrapper=’DDP’, dropout=0.1, empty_cache_freq=0, encoder_attention_heads=12, encoder_embed_dim=768, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=12, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=True, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, freq_weighted_replacement=False, gen_subset=’test’, heartbeat_timeout=-1, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, leave_unmasked_prob=0.1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format=’simple’, log_interval=1, lr=[0.0005], lr_scheduler=’polynomial_decay’, mask_multiple_length=1, mask_prob=0.15, mask_stdev=0.0, mask_whole_words=False, max_epoch=0, max_tokens=None, max_tokens_valid=None, max_update=125000, maximize_best_checkpoint_metric=False, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, nprocs_per_node=8, num_shards=1, num_workers=1, optimizer=’adam’, optimizer_overrides=’{}’, pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint=’never’, pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn=’tanh’, pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, random_token_prob=0.1, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=True, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file=’checkpoint_last.pt’, sample_break_mode=’complete’, save_dir=’checkpoints’, save_interval=1, save_interval_updates=0, scoring=’bleu’, seed=1, sentence_avg=False, shard_id=0, shorten_data_split_list=’’, shorten_method=’none’, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm=’LocalSGD’, slowmo_momentum=None, spectral_norm_classification_head=False, stop_min_lr=-1.0, stop_time_hours=0, task=’masked_lm’, tensorboard_logdir=None, threshold_loss_scale=None, tokenizer=None, tokens_per_sample=512, total_num_update=’125000’, tpu=False, train_subset=’train’, unk=3, untie_weights_roberta=False, update_freq=[16], use_bmuf=False, use_old_adam=False, user_dir=None, valid_subset=’valid’, validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=10000, weight_decay=0.01, zero_sharding=’none’), ‘task’: Namespace(_name=’masked_lm’, activation_dropout=0.0, activation_fn=’gelu’, adam_betas=’(0.9,0.98)’, adam_eps=1e-06, all_gather_list_size=16384, arch=’roberta_base’, attention_dropout=0.1, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric=’loss’, bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix=’’, clip_norm=0.0, cpu=False, criterion=’masked_lm’, curriculum=0, data=’data-bin/wikitext-103’, data_buffer_size=10, dataset_impl=None, ddp_backend=’c10d’, device_id=0, disable_validation=False, distributed_backend=’nccl’, distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=8, distributed_wrapper=’DDP’, dropout=0.1, empty_cache_freq=0, encoder_attention_heads=12, encoder_embed_dim=768, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=12, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=True, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, freq_weighted_replacement=False, gen_subset=’test’, heartbeat_timeout=-1, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, leave_unmasked_prob=0.1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format=’simple’, log_interval=1, lr=[0.0005], lr_scheduler=’polynomial_decay’, mask_multiple_length=1, mask_prob=0.15, mask_stdev=0.0, mask_whole_words=False, max_epoch=0, max_tokens=None, max_tokens_valid=None, max_update=125000, maximize_best_checkpoint_metric=False, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, nprocs_per_node=8, num_shards=1, num_workers=1, optimizer=’adam’, optimizer_overrides=’{}’, pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint=’never’, pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn=’tanh’, pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, random_token_prob=0.1, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=True, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file=’checkpoint_last.pt’, sample_break_mode=’complete’, save_dir=’checkpoints’, save_interval=1, save_interval_updates=0, scoring=’bleu’, seed=1, sentence_avg=False, shard_id=0, shorten_data_split_list=’’, shorten_method=’none’, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm=’LocalSGD’, slowmo_momentum=None, spectral_norm_classification_head=False, stop_min_lr=-1.0, stop_time_hours=0, task=’masked_lm’, tensorboard_logdir=None, threshold_loss_scale=None, tokenizer=None, tokens_per_sample=512, total_num_update=’125000’, tpu=False, train_subset=’train’, unk=3, untie_weights_roberta=False, update_freq=[16], use_bmuf=False, use_old_adam=False, user_dir=None, valid_subset=’valid’, validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=10000, weight_decay=0.01, zero_sharding=’none’), ‘criterion’: Namespace(_name=’masked_lm’, activation_dropout=0.0, activation_fn=’gelu’, adam_betas=’(0.9,0.98)’, adam_eps=1e-06, all_gather_list_size=16384, arch=’roberta_base’, attention_dropout=0.1, azureml_logging=False, batch_size=16, batch_size_valid=16, best_checkpoint_metric=’loss’, bf16=False, bpe=None, broadcast_buffers=False, bucket_cap_mb=25, checkpoint_shard_count=1, checkpoint_suffix=’’, clip_norm=0.0, cpu=False, criterion=’masked_lm’, curriculum=0, data=’data-bin/wikitext-103’, data_buffer_size=10, dataset_impl=None, ddp_backend=’c10d’, device_id=0, disable_validation=False, distributed_backend=’nccl’, distributed_init_method=None, distributed_no_spawn=False, distributed_port=-1, distributed_rank=0, distributed_world_size=8, distributed_wrapper=’DDP’, dropout=0.1, empty_cache_freq=0, encoder_attention_heads=12, encoder_embed_dim=768, encoder_ffn_embed_dim=3072, encoder_layerdrop=0, encoder_layers=12, encoder_layers_to_keep=None, end_learning_rate=0.0, eos=2, fast_stat_sync=False, find_unused_parameters=False, finetune_from_model=None, fix_batches_to_gpus=False, fixed_validation_seed=None, force_anneal=None, fp16=True, fp16_init_scale=128, fp16_no_flatten_grads=False, fp16_scale_tolerance=0.0, fp16_scale_window=None, freq_weighted_replacement=False, gen_subset=’test’, heartbeat_timeout=-1, keep_best_checkpoints=-1, keep_interval_updates=-1, keep_last_epochs=-1, leave_unmasked_prob=0.1, load_checkpoint_on_all_dp_ranks=False, localsgd_frequency=3, log_format=’simple’, log_interval=1, lr=[0.0005], lr_scheduler=’polynomial_decay’, mask_multiple_length=1, mask_prob=0.15, mask_stdev=0.0, mask_whole_words=False, max_epoch=0, max_tokens=None, max_tokens_valid=None, max_update=125000, maximize_best_checkpoint_metric=False, memory_efficient_bf16=False, memory_efficient_fp16=False, min_loss_scale=0.0001, model_parallel_size=1, no_epoch_checkpoints=False, no_last_checkpoints=False, no_progress_bar=False, no_save=False, no_save_optimizer_state=False, no_seed_provided=False, nprocs_per_node=8, num_shards=1, num_workers=1, optimizer=’adam’, optimizer_overrides=’{}’, pad=1, patience=-1, pipeline_balance=None, pipeline_checkpoint=’never’, pipeline_chunks=0, pipeline_decoder_balance=None, pipeline_decoder_devices=None, pipeline_devices=None, pipeline_encoder_balance=None, pipeline_encoder_devices=None, pipeline_model_parallel=False, pooler_activation_fn=’tanh’, pooler_dropout=0.0, power=1.0, profile=False, quant_noise_pq=0, quant_noise_pq_block_size=8, quant_noise_scalar=0, quantization_config_path=None, random_token_prob=0.1, required_batch_size_multiple=8, required_seq_len_multiple=1, reset_dataloader=False, reset_logging=True, reset_lr_scheduler=False, reset_meters=False, reset_optimizer=False, restore_file=’checkpoint_last.pt’, sample_break_mode=’complete’, save_dir=’checkpoints’, save_interval=1, save_interval_updates=0, scoring=’bleu’, seed=1, sentence_avg=False, shard_id=0, shorten_data_split_list=’’, shorten_method=’none’, skip_invalid_size_inputs_valid_test=False, slowmo_algorithm=’LocalSGD’, slowmo_momentum=None, spectral_norm_classification_head=False, stop_min_lr=-1.0, stop_time_hours=0, task=’masked_lm’, tensorboard_logdir=None, threshold_loss_scale=None, tokenizer=None, tokens_per_sample=512, total_num_update=’125000’, tpu=False, train_subset=’train’, unk=3, untie_weights_roberta=False, update_freq=[16], use_bmuf=False, use_old_adam=False, user_dir=None, valid_subset=’valid’, validate_after_updates=0, validate_interval=1, validate_interval_updates=0, wandb_project=None, warmup_updates=10000, weight_decay=0.01, zero_sharding=’none’), ‘optimizer’: {‘_name’: ‘adam’, ‘adam_betas’: ‘(0.9,0.98)’, ‘adam_eps’: 1e-06, ‘weight_decay’: 0.01, ‘use_old_adam’: False, ‘tpu’: False, ‘lr’: [0.0005]}, ‘lr_scheduler’: {‘_name’: ‘polynomial_decay’, ‘warmup_updates’: 10000, ‘force_anneal’: None, ‘end_learning_rate’: 0.0, ‘power’: 1.0, ‘total_num_update’: 125000.0, ‘lr’: [0.0005]}, ‘scoring’: {‘_name’: ‘bleu’, ‘pad’: 1, ‘eos’: 2, ‘unk’: 3}, ‘bpe’: None, ‘tokenizer’: None}</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.tasks.masked_lm | dictionary: 50264 types</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.data.data_utils | loaded 3760 examples from: data-bin/wikitext-103/valid</p>
<p>2020-12-28 15:40:45 | INFO | fairseq.tasks.masked_lm | loaded 580 blocks from: data-bin/wikitext-103/valid</p>
<p>2020-12-28 15:40:51 | INFO | fairseq_cli.train | RobertaModel(</p>
<p> (encoder): RobertaEncoder(</p>
<p>  (sentence_encoder): TransformerSentenceEncoder(</p>
<p>   (dropout_module): FairseqDropout()</p>
<p>   (embed_tokens): Embedding(50265, 768, padding_idx=1)</p>
<p>   (embed_positions): LearnedPositionalEmbedding(514, 768, padding_idx=1)</p>
<p>   (layers): ModuleList(</p>
<p>​    (0): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (1): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (2): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (3): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (4): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (5): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (6): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (7): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (8): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (9): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (10): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>​    (11): TransformerSentenceEncoderLayer(</p>
<p>​     (dropout_module): FairseqDropout()</p>
<p>​     (activation_dropout_module): FairseqDropout()</p>
<p>​     (self_attn): MultiheadAttention(</p>
<p>​      (dropout_module): FairseqDropout()</p>
<p>​      (k_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (v_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (q_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​      (out_proj): Linear(in_features=768, out_features=768, bias=True)</p>
<p>​     )</p>
<p>​     (self_attn_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​     (fc1): Linear(in_features=768, out_features=3072, bias=True)</p>
<p>​     (fc2): Linear(in_features=3072, out_features=768, bias=True)</p>
<p>​     (final_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>​    )</p>
<p>   )</p>
<p>   (emb_layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>  )</p>
<p>  (lm_head): RobertaLMHead(</p>
<p>   (dense): Linear(in_features=768, out_features=768, bias=True)</p>
<p>   (layer_norm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)</p>
<p>  )</p>
<p> )</p>
<p> (classification_heads): ModuleDict()</p>
<p>)</p>
<p>2020-12-28 15:40:51 | INFO | fairseq_cli.train | task: MaskedLMTask</p>
<p>2020-12-28 15:40:51 | INFO | fairseq_cli.train | model: RobertaModel</p>
<p>2020-12-28 15:40:51 | INFO | fairseq_cli.train | criterion: MaskedLmLoss</p>
<p>2020-12-28 15:40:51 | INFO | fairseq_cli.train | num. model params: 124696665 (num. trained: 124696665)</p>
<p>2020-12-28 15:40:56 | INFO | fairseq.trainer | detected shared parameter: encoder.sentence_encoder.embed_tokens.weight &lt;- encoder.lm_head.weight</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>CUDA enviroments for all 8 workers</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  0: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  1: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  2: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  3: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  4: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  5: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  6: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | rank  7: capabilities = 7.5 ; total memory = 23.653 GB ; name = TITAN RTX                </p>
<p>2020-12-28 15:40:57 | INFO | fairseq.utils | <strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><strong><em>CUDA enviroments for all 8 workers</em></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></strong></p>
<p>2020-12-28 15:40:57 | INFO | fairseq_cli.train | training on 8 devices (GPUs/TPUs)</p>
<p>2020-12-28 15:40:57 | INFO | fairseq_cli.train | max tokens per GPU = None and batch size per GPU = 16</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.trainer | Preparing to load checkpoint checkpoints/checkpoint_last.pt</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.trainer | No existing checkpoint found checkpoints/checkpoint_last.pt</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.trainer | loading train data for epoch 1</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.data.data_utils | loaded 1801350 examples from: data-bin/wikitext-103/train</p>
<p>2020-12-28 15:40:57 | INFO | fairseq.tasks.masked_lm | loaded 280678 blocks from: data-bin/wikitext-103/train</p>
<p>$fairseq$模型解析</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/141210591">https://zhuanlan.zhihu.com/p/141210591</a></p>
<p>![1](/学习fairseq之Roberta/截屏2020-12-28 下午4.38.11.png)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/28/%E5%AD%A6%E4%B9%A0fairseq%E4%B9%8BRoberta/" data-id="ckj8cn4ry00008ofyg0xz4f4s" data-title="学习fairseq之Roberta" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/12/30/%E7%94%A8docker%E9%83%A8%E7%BD%B2python%E7%8E%AF%E5%A2%83/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          用docker部署python环境
        
      </div>
    </a>
  
  
    <a href="/2020/12/25/AttributeError-module-enum-has-no-attribute-IntFlag/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">AttributeError: module &#39;enum&#39; has no attribute &#39;IntFlag&#39;</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/12/31/logistic%20regression/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/12/30/%E7%94%A8docker%E9%83%A8%E7%BD%B2python%E7%8E%AF%E5%A2%83/">用docker部署python环境</a>
          </li>
        
          <li>
            <a href="/2020/12/28/%E5%AD%A6%E4%B9%A0fairseq%E4%B9%8BRoberta/">学习fairseq之Roberta</a>
          </li>
        
          <li>
            <a href="/2020/12/25/AttributeError-module-enum-has-no-attribute-IntFlag/">AttributeError: module &#39;enum&#39; has no attribute &#39;IntFlag&#39;</a>
          </li>
        
          <li>
            <a href="/2020/12/25/%E6%9F%A5%E7%9C%8B%E5%BA%93%E7%9A%84%E7%89%88%E6%9C%AC/">查看库的版本</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2020 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>